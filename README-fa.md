# ูุนูุงุฑ ูฺฉุฑูุณุฑูุณ ุขูุงุฏู ูพุฑูุฏุงฺฉุดู ุจุง NestJS

ุงู ูพุฑูฺู ฺฉ ูุนูุงุฑ ูฺฉุฑูุณุฑูุณ ููุ ููุงุณโูพุฐุฑ ู ุขูุงุฏู ุจุฑุง ุงุณุชูุฑุงุฑ (Production-Ready) ุงุณุช ฺฉู ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฑูโูุฑฺฉ [NestJS](https://nestjs.com/) ุณุงุฎุชู ุดุฏู ุงุณุช. ูุฏู ุงู ูพุฑูฺูุ ูุฑุงูู ฺฉุฑุฏู ฺฉ ูพุงู ู ุงุณุงุณ (Boilerplate) ฺฉุงูู ุจุฑุง ุชูุณุนู ุณุฑุน ุงูพูฺฉุดูโูุง ูพฺุฏู ุงุณุชุ ุจู ุทูุฑ ฺฉู ุชูุงู ุฒุฑุณุงุฎุชโูุง ุถุฑูุฑ ุงุฒ ูพุด ูพุงุฏูโุณุงุฒ ุดุฏู ุจุงุดูุฏ.

ุงู ูุนูุงุฑ ุดุงูู ุงุฑุชุจุงุท ูุงููุฒูุงู ุจู ุณุฑูุณโูุง ุงุฒ ุทุฑู **Redis**ุ ุฐุฎุฑูโุณุงุฒ ุฏุงุฏู ุจุง **MongoDB**ุ ู ฺฉ **API Gateway** ุจู ุนููุงู ููุทู ูุฑูุฏ ูุชูุฑฺฉุฒ ุงุณุช.

## โจ ูฺฺฏโูุง ฺฉูุฏ (Core Features)

ุงู ูพุฑูฺู ููุท ฺฉ ุงูพูฺฉุดู ุณุงุฏู ูุณุชุ ุจูฺฉู ฺฉ ฺุงุฑฺูุจ ฺฉุงูู ุจุง ูฺฺฏโูุง ุฒุฑ ุงุณุช:

- \*\* ูุนูุงุฑ ูฺฉุฑูุณุฑูุณ:\*\* ุฌุฏุงุณุงุฒ ฺฉุงูู ููุทู ุจุฑูุงูู ุจู ุณุฑูุณโูุง ูุณุชูู (`users-service`, `auth-service`) ุจุฑุง ุญุฏุงฺฉุซุฑ ููุงุณโูพุฐุฑ ู ูุงุจูุช ูฺฏูุฏุงุฑ.
- \*\* ุงุฑุชุจุงุท ูุงููุฒูุงู:\*\* ุงุณุชูุงุฏู ุงุฒ **Redis** ุจู ุนููุงู ฺฉ Message Broker ูุฏุฑุชููุฏ ุจุฑุง ุงุฑุชุจุงุท ูพุงุฏุงุฑ ู ูุงููุฒูุงู ุจู ุณุฑูุณโูุง.
- \*\* ุงูฺฏู API Gateway:\*\* ฺฉ ููุทู ูุฑูุฏ ูุงุญุฏ (`api-gateway`) ฺฉู ูุณุฆููุช ูุณุฑุงุจุ ุงุนุชุจุงุฑุณูุฌ ุงููู ู ุชูุฒุน ุฏุฑุฎูุงุณุชโูุง ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ.
- \*\* ุงุญุฑุงุฒ ููุช ูุชูุฑฺฉุฒ ู ุงูู:\*\* ฺฉ ุณุฑูุณ ุงุฎุชุตุงุต `auth-service` ฺฉู ุจุง ุงุณุชูุงุฏู ุงุฒ **JWT (JSON Web Tokens)** ู ูฺฉุงูุฒู `Passport.js`ุ ูุธูู ุตุฏูุฑ ู ุงุนุชุจุงุฑุณูุฌ ุชูฺฉูโูุง ุฑุง ุจู ุตูุฑุช ุงุฒููู ุงูุฌุงู ูโุฏูุฏ.
- \*\* Rate Limiting ูพุดุฑูุชู ู ุฏุงูุงูฺฉ:\*\*
    - ฺฉ ฺฏุงุฑุฏ ุณุฑุงุณุฑ ู ููุดููุฏ ฺฉู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุจู ฺฉุงุฑุจุฑุงู ูุงฺฏู ฺฉุฑุฏู (ุจุฑ ุงุณุงุณ User ID) ู ฺฉุงุฑุจุฑุงู ูููุงู (ุจุฑ ุงุณุงุณ IP) ุชูุงุฒ ูุงุฆู ูโุดูุฏ.
    - ูุงุจูุช ุชุนุฑู ฺูุฏู ูุงููู ููุฒูุงู ุจุฑุง ูุฑ ูุณุฑ (ูุซูุงู ูุญุฏูุฏุช ุฏุฑ ุซุงูู ู ูุญุฏูุฏุช ุฏุฑ ุฏููู).
    - ูุงุจูุช ุชุนุฑู ูุญุฏูุฏุชโูุง ุฏุงูุงูฺฉ ุจุฑ ุงุณุงุณ ูพูู ฺฉุงุฑุจุฑ (ูุซูุงู `free` ุฏุฑ ููุงุจู `premium`) ฺฉู ุงุฒ ุชูฺฉู JWT ุฎูุงูุฏู ูโุดูุฏ.
- \*\* ูุงฺฏูฺฏ ุณุงุฎุชุงุฑุงูุชู ู ุฌุงูุน:\*\* ุงุณุชูุงุฏู ุงุฒ **Winston** ุจุฑุง ุซุจุช ูุงฺฏโูุง ุขูุงุฏู ูพุฑูุฏุงฺฉุดู ุจุง ูุฑูุช JSONุ ููุฑุงู ุจุง ฺฉ `LoggingInterceptor` ฺฉู ุชูุงู ุฌุฒุฆุงุช ุฏุฑุฎูุงุณุชโูุง ู ูพุงุณุฎโูุง ุฑุง ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุซุจุช ูโฺฉูุฏ.
- \*\* ูุฏุฑุช ุฎุทุง ูุชูุฑฺฉุฒ:\*\* ฺฉ `AllExceptionsFilter` ุณุฑุงุณุฑ ฺฉู ุชูุงู ุฎุทุงูุง ุจุฑูุงูู (ฺู HTTP ู ฺู ุฎุทุงูุง ุฏุงุฎู ูฺฉุฑูุณุฑูุณโูุง ุง `RpcException`) ุฑุง ุจู ุตูุฑุช ฺฉูพุงุฑฺู ุฏุฑุงูุช ฺฉุฑุฏู ู ฺฉ ูพุงุณุฎ ุงุณุชุงูุฏุงุฑุฏ ู ูุงุจู ููู ุจุฑูโฺฏุฑุฏุงูุฏ.
- \*\* ฺฉุชุงุจุฎุงูู ุงุดุชุฑุงฺฉ (`libs/common`):\*\* ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุชฺฉุฑุงุฑ ฺฉุฏ ู ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ูุงฺููโูุงุ DTOูุงุ ฺฏุงุฑุฏูุง ู ุงุจุฒุงุฑูุง ูุดุชุฑฺฉ ุจู ุชูุงู ุณุฑูุณโูุง.
- \*\* ูพฺฉุฑุจูุฏ ูุจุชู ุจุฑ ูุญุท:\*\* ุงุณุชูุงุฏู ุงุฒ ูุงูโูุง `.env` ูุฌุฒุง ุจุฑุง ูุฑ ุณุฑูุณ ู ุงุนุชุจุงุฑุณูุฌ ุขูโูุง ุจุง `Joi` ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงุฌุฑุง ุจุฑูุงูู ุจุง ุชูุธูุงุช ูุงูุต.
- \*\* ฺฉุงููุงู ุฏุงฺฉุฑุณุงุฒ ุดุฏู:\*\* ุชูุงู ูุนูุงุฑ (ุดุงูู ุณุฑูุณโูุงุ MongoDB ู Redis) ุจุง ฺฉ ุฏุณุชูุฑ `docker-compose up` ุจู ุตูุฑุช ฺฉุงูู ู ฺฉูพุงุฑฺู ุงุฌุฑุง ูโุดูุฏ.

## ๐๏ธ ููุง ฺฉู ูุนูุงุฑ

```
+----------------+   (HTTP Request)   +-----------------+   (Message via Redis)   +------------------+   (CRUD)   +-----------+
|                | -----------------> |                 | ----------------------> |                  | <--------> |           |
|  Client (Web/  |                    |   API Gateway   |                         |   Users Service  |            |  MongoDB  |
|     Mobile)    | <----------------- |                 | <---------------------- |                  | <--------> |           |
|                |   (HTTP Response)  |                 |   (Response via Redis)  |------------------+            +-----------+
+----------------+                    +-------+---------+                         |                  |
                                            |                                   |   Auth Service   |
                                            | (Message via Redis)               |                  |
                                            +---------------------------------> +------------------+
```

## ๐๏ธ ูพุดุชู ููุงูุฑ (Tech Stack)

- **ูุฑูโูุฑฺฉ ุงุตู:** [NestJS](https://nestjs.com/)
- **ุฒุจุงู:** [TypeScript](https://www.typescriptlang.org/)
- **ุฏุชุงุจุณ:** [MongoDB](https://www.mongodb.com/) (ุจุง ุงุณุชูุงุฏู ุงุฒ Mongoose)
- **ูุณุฌ ุจุฑูฺฉุฑ:** [Redis](https://redis.io/)
- **ฺฉุงูุชูุฑุณุงุฒ:** [Docker](https://www.docker.com/) & Docker Compose
- **ุงุญุฑุงุฒ ููุช:** [Passport.js](http://www.passportjs.org/) (ุงุณุชุฑุงุชฺ JWT)
- **ูุงฺฏูฺฏ:** [Winston](https://github.com/winstonjs/winston)
- **ุงุนุชุจุงุฑุณูุฌ:** [Joi](https://joi.dev/) ู `class-validator`

## ๐ ุฑุงูโุงูุฏุงุฒ ู ุงุฌุฑุง

ุจุฑุง ุงุฌุฑุง ุงู ูพุฑูฺู ุจู ุตูุฑุช ูุญูุ ุจู **Node.js (ูุณุฎู 18 ุง ุจุงูุงุชุฑ)** ู **Docker** ูุงุฒ ุฏุงุฑุฏ.

**ฑ. ุดุจูโุณุงุฒ ุฑูพุงุฒุชูุฑ:**

```bash
git clone https://github.com/YOUR_USERNAME/YOUR_REPOSITORY.git
cd YOUR_REPOSITORY
```

**ฒ. ูุตุจ ูุงุจุณุชฺฏโูุง:**

```bash
npm install
```

**ณ. ุงุฌุงุฏ ูุงูโูุง ูุชุบุฑูุง ูุญุท (`.env`):**
ุดูุง ุจุงุฏ ุณู ูุงู `.env` ูุฌุฒุง ุฏุฑ ูุณุฑูุง ูุดุฎุต ุดุฏู ุงุฌุงุฏ ฺฉูุฏ.

- **`apps/api-gateway/.env`:**

    ```env
    API_GATEWAY_PORT=3000
    REDIS_HOST=redis
    REDIS_PORT=6379
    ```

- **`apps/users-service/.env`:**

    ```env
    USERS_SERVICE_PORT=3001
    REDIS_HOST=redis
    REDIS_PORT=6379
    USERS_DB_URI=mongodb://mongo:27017/users_db
    ```

- **`apps/auth-service/.env`:**

    ```env
    AUTH_SERVICE_PORT=3002
    REDIS_HOST=redis
    REDIS_PORT=6379
    JWT_SECRET=YOUR_SUPER_SECRET_KEY_CHANGE_IT
    JWT_EXPIRATION=3600s
    ```

**ด. ุงุฌุฑุง ฺฉุงูู ูุนูุงุฑ ุจุง Docker Compose:**
ุงู ุฏุณุชูุฑ ุชูุงู ุงูุฌโูุง ุฑุง build ฺฉุฑุฏู ู ุชูุงู ฺฉุงูุชูุฑูุง ุฑุง ุงุฌุฑุง ูโฺฉูุฏ.

```bash
docker-compose up --build
```

ูพุณ ุงุฒ ฺูุฏ ูุญุธูุ ุชูุงู ุณุฑูุณโูุง ุดูุง ุจุงุฏ ุฏุฑ ุญุงู ุงุฌุฑุง ุจุงุดูุฏ.

## ๐งช ุชุณุช ู ุงุณุชูุงุฏู

ูโุชูุงูุฏ ุงุฒ ุงุจุฒุงุฑ ูุงููุฏ `curl` ุง Postman ุจุฑุง ุชุณุช ุงูุฏูพููุชโูุง ุงุณุชูุงุฏู ฺฉูุฏ.

**ฑ. ุซุจุชโูุงู ฺฉุงุฑุจุฑ ุฌุฏุฏ:**

```bash
curl -X POST -H "Content-Type: application/json" \
-d '{"email":"test@example.com", "password":"StrongPassword123"}' \
http://localhost:3000/api/users/sign-up
```

**ฒ. ูุงฺฏู ุจุง ฺฉุงุฑุจุฑ ุฌุฏุฏ:**

```bash
curl -X POST -H "Content-Type: application/json" \
-d '{"email":"test@example.com", "password":"StrongPassword123"}' \
http://localhost:3000/api/auth/login
```

ุฏุฑ ูพุงุณุฎุ ฺฉ ุชูฺฉู `accessToken` ุฏุฑุงูุช ุฎูุงูุฏ ฺฉุฑุฏ.

## ๐บ๏ธ ููุดู ุฑุงู ู ูุฑุงุญู ุจุนุฏ

- [ ] **ููุดุชู ุชุณุชโูุง:** ุงุถุงูู ฺฉุฑุฏู ุชุณุชโูุง Unitุ Integration ู E2E.
- [ ] **ุชฺฉูู Rate Limiter:** ูพุงุฏูโุณุงุฒ ููุทู ุณูููโุจูุฏ ูุงูุงูู (`fixed window`).
- [ ] **ุงูุฒูุฏู ุณุฑูุณโูุง ุฌุฏุฏ:** ุงุถุงูู ฺฉุฑุฏู ุณุฑูุณโูุง ุจุดุชุฑ ูุงููุฏ ูุญุตููุงุช ุง ุณูุงุฑุดุงุช.
- [ ] **ุฑุงูโุงูุฏุงุฒ CI/CD:** ุณุงุฎุช ูพุงูพโูุงู ุจุฑุง ุชุณุช ู ุจูุฏ ุฎูุฏฺฉุงุฑ.

## ๐ ูุฌูุฒ (License)

ุงู ูพุฑูฺู ุชุญุช ูุฌูุฒ [MIT](https://www.google.com/search?q=LICENSE) ููุชุดุฑ ุดุฏู ุงุณุช.
